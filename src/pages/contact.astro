---
import Layout from '../layouts/Layout.astro';

const pageTitle = "お問い合わせ | 髙橋遊月ピアノ教室";
---

<Layout title={pageTitle}>
    <section class="py-24 bg-[#EAE3DA] min-h-screen">
        <div class="max-w-2xl mx-auto px-6">
            <div class="bg-white p-12 rounded-[2rem] shadow-2xl border border-[#DCD3C7]">
                <h1 class="text-3xl font-serif font-bold mb-4 text-center">Contact</h1>
                <p class="text-center mb-12 text-sm tracking-widest">まずは無料体験レッスンからお気軽に。</p>
                
                <form id="contact-form" class="space-y-8">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="space-y-2">
                            <label class="block text-xs uppercase tracking-widest font-bold opacity-60">お名前</label>
                            <input type="text" name="name" required class="w-full border-b border-[#E8E2D9] py-2 focus:border-[#A88B58] outline-none transition-colors bg-transparent placeholder:text-[#DCD3C7] placeholder:font-light" placeholder="山田 佳子" />
                        </div>
                        <div class="space-y-2">
                            <label class="block text-xs uppercase tracking-widest font-bold opacity-60">お電話番号</label>
                            <input type="tel" name="tel" class="w-full border-b border-[#E8E2D9] py-2 focus:border-[#A88B58] outline-none transition-colors bg-transparent placeholder:text-[#DCD3C7] placeholder:font-light" placeholder="090-0000-0000" />
                        </div>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs uppercase tracking-widest font-bold opacity-60">メールアドレス</label>
                        <input type="email" name="email" required class="w-full border-b border-[#E8E2D9] py-2 focus:border-[#A88B58] outline-none transition-colors bg-transparent placeholder:text-[#DCD3C7] placeholder:font-light" placeholder="example@mail.com" />
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs uppercase tracking-widest font-bold opacity-60">希望コース</label>
                        <select name="course" class="w-full border-b border-[#E8E2D9] py-2 focus:border-[#A88B58] outline-none transition-colors bg-transparent cursor-pointer">
                            <option>出張体験レッスン</option>
                            <option>30分レッスン</option>
                            <option>45分レッスン</option>
                            <option>60分レッスン</option>
                            <option>その他（ご相談など）</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs uppercase tracking-widest font-bold opacity-60">メッセージ</label>
                        <textarea name="message" rows="3" class="w-full border-b border-[#E8E2D9] py-2 focus:border-[#A88B58] outline-none transition-colors bg-transparent placeholder:text-[#DCD3C7] placeholder:font-light resize-none" placeholder="レッスンへのご要望やご住所の目安など"></textarea>
                    </div>
                    <button 
                        type="submit" id="submit-btn" class="w-full bg-[#544A40] text-white py-5 rounded-full font-bold hover:bg-[#3D352E] transition-all shadow-lg tracking-[0.3em] text-xs uppercase">
                        送信する
                    </button>
                </form>
            </div>
        </div>
    </section>

    <script is:inline>
        const form = document.getElementById('contact-form');
        const btn = document.getElementById('submit-btn');
        // GASウェブアプリURL
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwruAuBvHur-ZGDyQcKIPqKCoBRDDhwBPy2a-Y11vH1htI0Yj1dCgg9y4xIqLfK_u7yTQ/exec";
        
        if (form) {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                btn.disabled = true;
                btn.innerText = 'Sending...';
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                try {
                    await fetch(GAS_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 
                            'Content-Type': 'text/plain' 
                        },
                        body: JSON.stringify(data),
                    });
                    
                    alert('お問い合わせありがとうございます。内容を確認し、折り返しご連絡いたします。');
                    form.reset();
                } catch (error) {
                    console.error('Error:', error);
                    alert('送信中にエラーが発生しました。');
                } finally {
                    btn.disabled = false;
                    btn.innerText = '送信する';
                }
            });
        }
    </script>
</Layout>